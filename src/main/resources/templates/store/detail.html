<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title>가게 상세 페이지</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
</head>
<div layout:fragment="content" th:each="s:${stores}">
  <div class="image-container">
    <img th:src="'http://localhost:8088'+${s.mainImg}" alt="대표 이미지">
    <img src="/public/img/store/dog.jpg" alt="이미지 설명">
    <div class="last-column">
      <img src="/public/img/store/curry.jpg" alt="이미지 설명">
      <img src="/public/img/store/rice.jpg" alt="이미지 설명">
    </div>
  </div>
  <div class="store">
    <p class="storeName d-flex justify-content-center mt-4" th:text="${s.storeName}"></p>
    <a class="btn btn-secondary btn-sm mt-3">추천</a>
  </div>
  <div class="store">
    <span class="starPoint">★4.45</span>
    <span class="starReview">/방문자리뷰 132</span>
  </div>
  <div class="store">
    <span class="starHashTag1 me-2">#해시태그1</span>
    <span class="starHashTag2 me-2">#해시태그2</span>
    <span class="starHashTag3 me-2">#해시태그3</span>
    <span class="starHashTag4 me-2">#해시태그4</span>
    <span class="starHashTag5 me-2">#해시태그5</span>
  </div>
  <div class="store">
    <p class="waitingTeam">현재 10팀 대기중입니다.</p>
  </div>
  <div class="store">
    <a class="btn btn-outline-dark btn-sm">찜</a>
    <a id="share-btn" class="btn btn-outline-dark btn-sm" data-clipboard-text="https://example.com">공유</a>
    <a class="btn btn-outline-dark btn-sm" th:href="${s.instaurl}">인스타</a>
    <a class="btn btn-outline-dark btn-sm" th:href="${s.facebookurl}">페이스북</a>
    <a class="btn btn-outline-dark btn-sm" th:href="${s.youtubeurl}">유튜브</a>
    <a class="btn btn-outline-dark btn-sm" th:href="${s.blogurl}">블로그</a>
  </div>
  <div class="store">
    <div class="storeDetail">
      <p>패스트 푸드</p>
      <p th:text="${s.address}"></p>
      <details>
        <summary>영업시간</summary>
        <p th:text="'영업시간 : '+${s.opentime}"></p>
        <p>브레이크 타임</p>
        <p th:text="'주문 마감시간 : '+${s.lastorder}"></p>
        <p th:text="'웨이팅 마감시간 : '+${s.waitingClosetime}"></p>
      </details>
      <p th:text="${s.storeCall.storeCall}"></p>
      <span th:if="${s.parking}">주차가능</span>
      <span th:if="${s.wifi}">와이파이 </span>
      <span th:if="${s.toilet}">화장실 </span>
      <span th:if="${s.smokingroom}">흡연실 </span>
      <span th:if="${s.babychair}">아기의자 </span>
      <p th:text="${s.tvshow}"></p>
      <p th:text="${s.detailInfo}"></p>
    </div>
  </div>
  <div class="store">
    <a href="#menu">메뉴</a>
    <a href="#review">리뷰</a>
    <a href="#map">지도</a>
  </div>

  <div class="store mt-2" th:each="cd:${s.chapDealList}">
    <div class="chapDeal card" style="width:600px;">
      <img th:src="'http://localhost:8088'+${cd.eventImg}" class="card-img-top" style="height:250px;">
      <div class="card-img-overlay p-0">
        <div th:text="${cd.eventTitle}" class="bookMark d-inline p-2"></div>
      </div>
      <div class="card-body">
        <small th:text="${#dates.format(cd.eventStart,'yyyy-MM-dd')+'~'+#dates.format(cd.eventEnd,'yyyy-MM-dd')}"></small>
        <div class="d-flex justify-content-between mt-4">
          <p th:text="${cd.eventCondition}" class="mb-0"></p>
          <h4 th:text="${cd.eventReward}" class="reward mb-0"></h4>
        </div>
      </div>
    </div>
  </div>

  <div id="menu">

    <h5 class="store mt-3">신메뉴</h5>
    <div class="store newMenu mt-3">
      <div class="col-md-2" th:each="m:${s.menuList}">
        <div th:if="${m.menuType == '신메뉴'}">
          <img th:src="'http://localhost:8088'+${m.img}" style="width: 150px; height: 150px;">
          <details>
            <summary class="mb-0" th:text="${m.name}+' '+${m.price}+'원'"></summary>
            <p th:text="${m.info}"></p>
          </details>
        </div>
      </div>
    </div>

    <h5 class="store mt-3">대표메뉴</h5>
    <div class="store newMenu mt-3">
      <div class="col-md-2" th:each="m:${s.menuList}">
        <div th:if="${m.menuType == '대표메뉴'}">
          <img th:src="'http://localhost:8088'+${m.img}" style="width: 150px; height: 150px;">
          <details>
            <summary class="mb-0" th:text="${m.name}+' '+${m.price}+'원'"></summary>
            <p th:text="${m.info}"></p>
          </details>
        </div>
      </div>
    </div>

    <div class="store mt-3">
      <div class="menuBoard row">
        <div class="col-md-6" th:each="m:${s.menuList}">
          <img th:src="'http://localhost:8088'+${m.img}" style="width: 100px; height: 100px;">
          <details>
            <summary class="mb-0" th:text="${m.name}+' '+${m.price}+'원'"></summary>
            <p th:text="${m.info}"></p>
          </details>
        </div>
      </div>
    </div>

  </div>

  <div id="review">
    <div class="store" th:each="r,iter:${s.reviewList}">
      <!-- 리뷰 목록 -->

      <div class="reviews" style="width: 600px; height: 400px; border: #222 solid 1px;" th:classappend="${iter.index >= 3} ? 'hide' : ''">
        <!-- 상단 -->
        <div class="review-container d-flex justify-content-between">
          <!-- 상단 왼쪽 영역 -->
          <div class="user-info d-flex">
            <img th:src="${r.userInfo.profileImg}" style="width: 50px; height: 50px; border-radius: 50%; border: #222 solid 1px" >
            <p class="user-name" th:text="${r.userInfo.nickname}"></p>
            <a class="btn btn-outline-dark" style="height: 30px; padding: 5px;">팔로우</a>
            <p class="review-count">리뷰개수:3</p>
          </div>
          <!-- 상단 오른쪽 영역 -->
          <div class="review-info">
            <div class="d-flex">
              <p th:text="'★'+${r.star}" class="rating-value"></p>
              <i class="bi bi-hand-thumbs-up"></i>
              <i class="bi bi-hand-thumbs-down"></i>
            </div>
            <a class="btn btn-outline-dark btn-sm">신고하기</a>
            <!--          <button class="btn btn-dark float-right">삭제</button>-->
          </div>
        </div>

        <!-- 중앙 영역 -->
        <div class="review-content d-flex mt-3">
          <img th:src="'http://localhost:8088'+${r.img}" style="width: 150px; height: 150px;">
          <div class="review-text">
            <p th:text="${r.content}" class="review-description m-0" style="border: #222 solid 1px; width: 440px; height: 100px;"></p>
            <p th:text="${r.comment}" class="menu-comment" style="border: #222 solid 1px; width: 440px; height: 50px;"></p>
          </div>
        </div>
        <div class="review-comment d-flex">
          <p class="review-description ms-5" style="border: #222 solid 1px; width: 540px; height: 100px;">저희 가게를 이용해주셔서 감사합니다</p>
        </div>
      </div>
    </div>
    <div class="store">
      <a class="btn btn-dark" id="show-more">더보기</a>
    </div>
  </div>

  <div id="map" class="store mt-4">
    <div style="width: 600px; height: 400px; border: #222 solid 1px;">
      지도가 들어갈거에요
    </div>
  </div>

</div>
</html>

<script>
  document.querySelector('[data-clipboard-text]').setAttribute('data-clipboard-text', window.location.href);
  var clipboard = new ClipboardJS('#share-btn');
  clipboard.on('success', function(e) {
    alert('주소가 복사되었습니다.');
  });

  const button = document.getElementById('show-more');
  const hiddenItems = document.querySelectorAll('.hide');
  let currentIdx = 0;

  button.addEventListener('click', () => {
    for (let i = currentIdx; i < currentIdx + 3; i++) {
      if (hiddenItems[i]) {
        hiddenItems[i].classList.remove('hide');
      } else {
        button.hidden = true;
        break;
      }
    }
    currentIdx += 3;
  });
</script>
<style>
  img{
    object-fit: cover;
  }

  .hide {
    display: none; /*리뷰 숨기기*/
  }

  .image-container {
    display: flex;
    justify-content: center; /* 수평 중앙 정렬 */
  }

  .image-container {
    display: flex;
    flex-wrap: wrap;
  }

  .image-container img {
    width: calc(25%);
    height: 200px;
  }

  .last-column {
    width: calc(30%);
    display: flex;
    flex-direction: column;
  }

  .last-column img {
    width: calc(100%);
    height: 100px;
  }

  .store {
    display: flex;
    justify-content: center;
    /*align-items: center;*/
  }

  .storeName {
    font-size: 40px;
    margin-right: 10px;
  }

  .starPoint, .starReview{
    font-size: 30px;
  }

  .waitingTeam{
    border: #222 solid 1px;
    padding: 5px;
    margin-bottom: 5px;
  }

  .storeDetail{
    border: #222 solid 1px;
  }


  .card-img-overlay .d-inline {
    position: relative;
    top: 20px;
    left: -5px;
  }
  .card-body {
    background-color: #FFE3A9;
    margin-bottom: 0px;
  }
  .card-text{
    display: inline-block;
    font-weight: bold;
  }
  .bookMark{
    background-color: #FF5D5D;
    border-radius: 0px 5px 5px 0px;
    color:#fff;
    font-weight:bold;
  }
  .reward{
    color: #FF5D5D;
    font-weight: bold;
  }
</style>